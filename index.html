<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Maker</title>
<script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: #f5f5f7;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
}
.container {
  background: white;
  border-radius: 16px;
  padding: 32px;
  max-width: 480px;
  width: 100%;
  box-shadow: 0 4px 24px rgba(0,0,0,0.08);
}
h1 {
  font-size: 1.5rem;
  margin-bottom: 24px;
  text-align: center;
}
.field { margin-bottom: 16px; }
label {
  display: block;
  font-size: 0.85rem;
  font-weight: 600;
  color: #555;
  margin-bottom: 4px;
}
input {
  width: 100%;
  padding: 10px 12px;
  border: 1.5px solid #ddd;
  border-radius: 8px;
  font-size: 1rem;
  transition: border-color 0.2s;
}
input:focus {
  outline: none;
  border-color: #4a90d9;
}
button {
  width: 100%;
  padding: 12px;
  background: #4a90d9;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  margin-top: 8px;
  transition: background 0.2s;
}
button:hover { background: #3a7bc8; }
#qr-output {
  margin-top: 24px;
  text-align: center;
  display: none;
}
#qr-canvas {
  border-radius: 4px;
}
#generated-url {
  margin-top: 12px;
  font-size: 0.75rem;
  color: #888;
  word-break: break-all;
}
.download-btn {
  display: inline-block;
  margin-top: 12px;
  padding: 8px 24px;
  background: #34c759;
  color: white;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
}
.download-btn:hover { background: #2db84d; }
</style>
</head>
<body>
<div class="container">
  <h1>üî≤ QR Maker</h1>
  <div class="field">
    <label for="url">URL</label>
    <input type="url" id="url" placeholder="https://example.com">
  </div>
  <div class="field">
    <label for="param-c">ÁîüÂçî„Ç≥„Éº„Éâ</label>
    <input type="text" id="param-c" placeholder="ÂÄ§„ÇíÂÖ•Âäõ">
  </div>
  <div class="field">
    <label for="param-source">utm_source</label>
    <input type="text" id="param-source" placeholder="‰æã: google">
  </div>
  <div class="field">
    <label for="param-medium">utm_medium</label>
    <input type="text" id="param-medium" placeholder="‰æã: cpc">
  </div>
  <div class="field">
    <label for="param-campaign">utm_campaign</label>
    <input type="text" id="param-campaign" placeholder="‰æã: spring2026">
  </div>
  <div class="field">
    <label for="qr-size">QR„Ç≥„Éº„Éâ„Çµ„Ç§„Ç∫Ôºà„Éî„ÇØ„Çª„É´Ôºâ</label>
    <input type="number" id="qr-size" value="300" min="64" max="2048" step="1">
  </div>
  <button onclick="generateQR()">QR„Ç≥„Éº„Éâ„ÇíÁîüÊàê</button>
  <div id="qr-output">
    <canvas id="qr-canvas"></canvas>
    <p id="generated-url"></p>
    <a id="download-link" class="download-btn" download="qrcode.png">PNG„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</a>
  </div>
</div>
<script>
function generateQR() {
  const url = document.getElementById('url').value.trim();
  if (!url) { alert('URL„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ'); return; }

  const params = [];
  const c = document.getElementById('param-c').value.trim();
  const source = document.getElementById('param-source').value.trim();
  const medium = document.getElementById('param-medium').value.trim();
  const campaign = document.getElementById('param-campaign').value.trim();

  if (c) params.push('c=' + encodeURIComponent(c));
  if (source) params.push('utm_source=' + encodeURIComponent(source));
  if (medium) params.push('utm_medium=' + encodeURIComponent(medium));
  if (campaign) params.push('utm_campaign=' + encodeURIComponent(campaign));

  const sep = url.includes('?') ? '&' : '?';
  const fullUrl = params.length > 0 ? url + sep + params.join('&') : url;

  const size = parseInt(document.getElementById('qr-size').value) || 512;

  const qr = qrcode(0, 'M');
  qr.addData(fullUrl);
  qr.make();

  const moduleCount = qr.getModuleCount();
  const margin = 4; // quiet zone in modules
  const totalModules = moduleCount + margin * 2;
  const canvas = document.getElementById('qr-canvas');
  canvas.width = size;
  canvas.height = size;
  const ctx = canvas.getContext('2d');

  // White background
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0, 0, size, size);

  // Draw QR modules
  const cellSize = size / totalModules;
  ctx.fillStyle = '#000000';
  for (let row = 0; row < moduleCount; row++) {
    for (let col = 0; col < moduleCount; col++) {
      if (qr.isDark(row, col)) {
        ctx.fillRect(
          Math.floor((col + margin) * cellSize),
          Math.floor((row + margin) * cellSize),
          Math.ceil(cellSize),
          Math.ceil(cellSize)
        );
      }
    }
  }

  document.getElementById('generated-url').textContent = fullUrl;
  document.getElementById('download-link').href = canvas.toDataURL('image/png');
  document.getElementById('qr-output').style.display = 'block';
}
</script>
</body>
</html>
